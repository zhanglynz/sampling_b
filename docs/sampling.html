<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Understanding Sampling | Uderstanding Survey Sampling</title>
  <meta name="description" content="2 Understanding Sampling | Uderstanding Survey Sampling" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Understanding Sampling | Uderstanding Survey Sampling" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Understanding Sampling | Uderstanding Survey Sampling" />
  
  
  

<meta name="author" content="Lingyun Zhang" />


<meta name="date" content="2024-08-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sample.html"/>
<link rel="next" href="weighting-system.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="sample.html"><a href="sample.html"><i class="fa fa-check"></i><b>1</b> Understanding Sample</a>
<ul>
<li class="chapter" data-level="1.1" data-path="sample.html"><a href="sample.html#what-is-a-sample"><i class="fa fa-check"></i><b>1.1</b> What is a sample?</a></li>
<li class="chapter" data-level="1.2" data-path="sample.html"><a href="sample.html#what-is-a-good-sample"><i class="fa fa-check"></i><b>1.2</b> What is a good sample?</a></li>
<li class="chapter" data-level="1.3" data-path="sample.html"><a href="sample.html#on-sampling-error"><i class="fa fa-check"></i><b>1.3</b> On sampling error</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="sampling.html"><a href="sampling.html"><i class="fa fa-check"></i><b>2</b> Understanding Sampling</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sampling.html"><a href="sampling.html#general-ideas"><i class="fa fa-check"></i><b>2.1</b> General ideas</a></li>
<li class="chapter" data-level="2.2" data-path="sampling.html"><a href="sampling.html#three-theoretical-principles"><i class="fa fa-check"></i><b>2.2</b> Three theoretical principles</a></li>
<li class="chapter" data-level="2.3" data-path="sampling.html"><a href="sampling.html#sampling-in-practice"><i class="fa fa-check"></i><b>2.3</b> Sampling in practice</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="sampling.html"><a href="sampling.html#sys1"><i class="fa fa-check"></i><b>2.3.1</b> Systematic sampling</a></li>
<li class="chapter" data-level="2.3.2" data-path="sampling.html"><a href="sampling.html#probability-proportional-to-size"><i class="fa fa-check"></i><b>2.3.2</b> Probability proportional to size</a></li>
<li class="chapter" data-level="2.3.3" data-path="sampling.html"><a href="sampling.html#systematic-sampling-with-unequal-selection-probabilities"><i class="fa fa-check"></i><b>2.3.3</b> Systematic sampling with unequal selection probabilities</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="sampling.html"><a href="sampling.html#exercises"><i class="fa fa-check"></i><b>2.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="sampling.html"><a href="sampling.html#unit-selection-probability-in-srs"><i class="fa fa-check"></i><b>2.4.1</b> Unit selection probability in SRS</a></li>
<li class="chapter" data-level="2.4.2" data-path="sampling.html"><a href="sampling.html#all-possible-samples-for-srs-with-replacement"><i class="fa fa-check"></i><b>2.4.2</b> All possible samples for SRS with replacement</a></li>
<li class="chapter" data-level="2.4.3" data-path="sampling.html"><a href="sampling.html#an-algorithm-for-drawing-an-srs"><i class="fa fa-check"></i><b>2.4.3</b> An algorithm for drawing an SRS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="weighting-system.html"><a href="weighting-system.html"><i class="fa fa-check"></i><b>3</b> Weighting System</a>
<ul>
<li class="chapter" data-level="3.1" data-path="weighting-system.html"><a href="weighting-system.html#general-ideas-about-weighting"><i class="fa fa-check"></i><b>3.1</b> General ideas about weighting</a></li>
<li class="chapter" data-level="3.2" data-path="weighting-system.html"><a href="weighting-system.html#the-three-stages-in-producing-final-weights"><i class="fa fa-check"></i><b>3.2</b> The three stages in producing final weights</a></li>
<li class="chapter" data-level="3.3" data-path="weighting-system.html"><a href="weighting-system.html#calibration"><i class="fa fa-check"></i><b>3.3</b> Calibration</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="estimation-with-survey-data.html"><a href="estimation-with-survey-data.html"><i class="fa fa-check"></i><b>4</b> Estimation With Survey Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="estimation-with-survey-data.html"><a href="estimation-with-survey-data.html#estimating-the-total"><i class="fa fa-check"></i><b>4.1</b> Estimating the total</a></li>
<li class="chapter" data-level="4.2" data-path="estimation-with-survey-data.html"><a href="estimation-with-survey-data.html#estimating-the-mean"><i class="fa fa-check"></i><b>4.2</b> Estimating the mean</a></li>
<li class="chapter" data-level="4.3" data-path="estimation-with-survey-data.html"><a href="estimation-with-survey-data.html#estimating-quantiles"><i class="fa fa-check"></i><b>4.3</b> Estimating quantiles</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sampling-errors.html"><a href="sampling-errors.html"><i class="fa fa-check"></i><b>5</b> Sampling Errors</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Uderstanding Survey Sampling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sampling" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">2</span> Understanding Sampling<a href="sampling.html#sampling" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="general-ideas" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> General ideas<a href="sampling.html#general-ideas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Throughout this chapter, <em>sampling</em> means <em>probability sampling</em>. Following (but not strictly) Tillé and Wilhelm (2017), the settings are as follows:</p>
<ul>
<li>The <em>population</em> is <span class="math inline">\({\cal P}=\{1, 2, \ldots, i, \ldots, N\}\)</span>.</li>
<li>A <em>sample</em> <span class="math inline">\(s\)</span> is a subset of <span class="math inline">\({\cal P}\)</span>. Note that <span class="math inline">\(s\)</span> can be empty.</li>
<li>There are <span class="math inline">\(2^N\)</span> possible samples. Let the set of all the possible samples be denoted by <span class="math inline">\(\Omega\)</span>.</li>
</ul>
<p>A <em>sampling design</em> specifies a probability distribution <span class="math inline">\(p(\cdot)\)</span> over <span class="math inline">\(\Omega\)</span> such that
<span class="math display">\[
p(s)\ge 0\ \hbox{and}\ \sum_{s\in \Omega} p(s)=1.
\]</span></p>
<p>Define
<span class="math display">\[
\pi_i = \hbox{the probability of selecting unit}\ i
\]</span>
and for <span class="math inline">\(i\neq j\)</span>
<span class="math display">\[
\pi_{ij} = \hbox{the probability that both units}\ i\ \hbox{and}\ j\ \hbox{are selected in the sample.}
\]</span>
Then,
<span class="math display">\[
\pi_i = \sum_{i \in s}p(s)\ \hbox{and}\ \pi_{ij}=\sum_{\{i,\ j\}\subset s}p(s).
\]</span></p>
<p>Examples of sampling designs:</p>
<ul>
<li><strong>Simple random sampling:</strong>
<span class="math display">\[
p(s)=\left\{
\begin{array}{ll}
{N \choose n}^{-1}, &amp; \hbox{if}\ s\in S_n,\\
0, &amp; \hbox{otherwise},
\end{array}
\right.
\]</span>
where <span class="math inline">\(S_n= \{s\in \Omega|\#s = n\}\)</span> and <span class="math inline">\(n\)</span> is the sample size. For this sampling design,
<span class="math display">\[
\pi_i = \frac{n}{N}\ \hbox{and}\ \pi_{ij}= \frac{n(n-1)}{N(N-1)}.
\]</span>
The essential in the simple random sampling is that <strong>all possible subsets having <span class="math inline">\(n\)</span> units are equally likely to be chosen.</strong></li>
<li><strong>Stratified sampling:</strong>
<span class="math display">\[
p(s)=\left\{
\begin{array}{ll}
\prod_{h=1}^H{N_h \choose n_h}^{-1}, &amp;\hbox{if}\ \#(s\bigcap {\cal P}_h)=n_h\ \hbox{for}\ h=1,\ldots, H,\\
0, &amp; \hbox{otherwise},
\end{array}
\right.
\]</span>
where the population <span class="math inline">\({\cal P}\)</span> is partitioned into <span class="math inline">\(H\)</span> strata and <span class="math inline">\(\# {\cal P}_h= N_h\)</span> for <span class="math inline">\(h=1, \ldots, H\)</span>; <span class="math inline">\(n_h\)</span> is the sample size for stratum <span class="math inline">\({\cal P}_h\)</span>. For this sampling design,
<span class="math display">\[
\pi_i = \frac{n_h}{N_h},\ \hbox{if}\ i\in {\cal P}_h,
\]</span>
and
<span class="math display">\[
\pi_{ij}=\left\{
\begin{array}{ll}
\frac{n_h(n_h-1)}{N_h(N_h-1)}, &amp; \hbox{if}\ i, j\in {\cal P}_h,\\
\frac{n_gn_h}{N_gN_h}, &amp;\hbox{if}\ i \in {\cal P}_g,\ j\in {\cal P}_h,\ g\neq h.
\end{array}
\right.
\]</span></li>
<li><strong>Bernoulli sampling:</strong>
<span class="math display">\[
\pi_i = p,\ \hbox{where}\ 0 &lt; p &lt; 1,\ \hbox{for}\ i=1, \ldots, N;
\]</span>
sample <span class="math inline">\(s\)</span> has units that are
<strong>independently</strong> selected. Note that for Bernoulli sampling, <em>sample size</em> is a random variable and it follows the
Binomial<span class="math inline">\((N, p)\)</span> distribution. The mean of the sample size is equal to <span class="math inline">\(Np\)</span>. Obviously,
<span class="math display">\[\pi_{ij}=p^2\ \hbox{for}\ i\neq j.\]</span> All the possible samples in <span class="math inline">\(\Omega\)</span> can be classified into
<span class="math inline">\(N+1\)</span> classes using their <em>cardinality</em> (number of elements in a set), and we can check that</li>
</ul>
<p><span class="math display">\[
\begin{array}{cl}
&amp;\sum_{i=0,\ \#s = i}^Np(s)\\
=&amp;\sum_{i=0}^N {N \choose i}p^i(1-p)^{N-i}\\
=&amp;1.
\end{array}
\]</span></p>
<ul>
<li><strong>Poisson sampling:</strong>
The setting is the same as that in Bernoulli sampling except that the
selection probabilities for units are not all equal. The distribution of the sample size is
called <em>Poisson binomial distribution</em>.</li>
<li><strong>Conditional Poisson sampling:</strong>
This design has prescribed <strong>unequal inclusion probabilities</strong> but results in samples with <strong>fixed sample size</strong>; see more details in Tillé and Wilhelm (2017).</li>
</ul>
</div>
<div id="three-theoretical-principles" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Three theoretical principles<a href="sampling.html#three-theoretical-principles" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Tillé and Wilhelm (2017)
introduce three theoretical principles for sampling design.</p>
<ul>
<li><p><strong>Randomization:</strong> a) make sure there are as many samples as possible, while meeting other constraints; b) select a sample at random.</p></li>
<li><p><strong>Overrepresentation:</strong> unequal inclusion probabilities often result in more efficient estimates, or in other words, we should “preferentially select units where the dispersion is larger.”</p></li>
<li><p><strong>Restriction:</strong> avoid bad samples, e.g. using auxiliary information to make sure the estimates from a sample approximately equal the known totals. That is, “samples that either nonpractical or known to be inaccurate are avoided.”</p></li>
</ul>
<p>We quote the following from Tillé and Wilhelm (2017).</p>
<blockquote>
<p>When auxiliary information is available, it is desired to include it in the sampling design in order to increase the precision of the estimates.</p>
</blockquote>
<blockquote>
<p>A balanced sample is such that the estimated totals of the auxiliary variables are approximately equal to the true totals.</p>
</blockquote>
<blockquote>
<p>At first glance, the principle of restriction seems to be in contradiction with the principle
of randomization because it restricts the number of possible number of samples with
nonnull probabilities. However, the possible number of samples is so large that, even with
several constraints, the number of possible samples with nonnull probabilities can remain very
large.</p>
</blockquote>
</div>
<div id="sampling-in-practice" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Sampling in practice<a href="sampling.html#sampling-in-practice" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="sys1" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Systematic sampling<a href="sampling.html#sys1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As mentioned before, population and sample sizes are <span class="math inline">\(N\)</span> and <span class="math inline">\(n\)</span>, respectively.
The ideas in systematic sampling can be described as follows.</p>
<ol style="list-style-type: decimal">
<li>The units in the population are put in some order, say, units <span class="math inline">\(1,\ 2,\ \ldots,\ N\)</span>.</li>
<li>Randomly choose a unit as the <em>start</em>, e.g. start is unit <span class="math inline">\(a\)</span>, where <span class="math inline">\(1\le a\le N\)</span>.</li>
<li>The <em>jump number</em> is <span class="math inline">\(k\)</span>, which is the greatest integer less than or equal to <span class="math inline">\(N/n\)</span>, i.e. <span class="math inline">\(k = \hbox{floor}(N/n)\)</span>. Then the <span class="math inline">\(n\)</span> units
<span class="math display">\[a;\ (a+k)\ \hbox{mod}\ N;\ \ldots;\  (a+(n-1)k)\ \hbox{mod}\ N\]</span>
are chosen as the sample. NB: If the result of the mod operation is 0, then unit <span class="math inline">\(N\)</span> is chosen into sample.</li>
</ol>
<p><strong>R program:</strong></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="sampling.html#cb1-1" aria-hidden="true" tabindex="-1"></a>sys_sampling <span class="ot">&lt;-</span> <span class="cf">function</span>(N, n, <span class="at">start =</span> <span class="cn">NULL</span>, <span class="at">indi_output =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-2"><a href="sampling.html#cb1-2" aria-hidden="true" tabindex="-1"></a>{<span class="co"># interval</span></span>
<span id="cb1-3"><a href="sampling.html#cb1-3" aria-hidden="true" tabindex="-1"></a> k <span class="ot">&lt;-</span> <span class="fu">floor</span>(N <span class="sc">/</span> n)</span>
<span id="cb1-4"><a href="sampling.html#cb1-4" aria-hidden="true" tabindex="-1"></a> <span class="co"># start</span></span>
<span id="cb1-5"><a href="sampling.html#cb1-5" aria-hidden="true" tabindex="-1"></a> <span class="cf">if</span>(<span class="fu">is.null</span>(start)) start <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(<span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">*</span> N)</span>
<span id="cb1-6"><a href="sampling.html#cb1-6" aria-hidden="true" tabindex="-1"></a> <span class="cf">if</span>(<span class="sc">!</span>start <span class="sc">%in%</span> 1L<span class="sc">:</span>N) <span class="fu">stop</span>(<span class="st">&quot;&#39;start&#39; must be integer between 1 and N!&quot;</span>)</span>
<span id="cb1-7"><a href="sampling.html#cb1-7" aria-hidden="true" tabindex="-1"></a> <span class="co"># sample</span></span>
<span id="cb1-8"><a href="sampling.html#cb1-8" aria-hidden="true" tabindex="-1"></a> the_sample <span class="ot">&lt;-</span> (start <span class="sc">+</span> (<span class="dv">0</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">*</span> k) <span class="sc">%%</span> N </span>
<span id="cb1-9"><a href="sampling.html#cb1-9" aria-hidden="true" tabindex="-1"></a> the_sample <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(the_sample <span class="sc">==</span> 0L, N, the_sample)</span>
<span id="cb1-10"><a href="sampling.html#cb1-10" aria-hidden="true" tabindex="-1"></a> the_sample <span class="ot">&lt;-</span> <span class="fu">sort</span>(the_sample)</span>
<span id="cb1-11"><a href="sampling.html#cb1-11" aria-hidden="true" tabindex="-1"></a> <span class="co"># output</span></span>
<span id="cb1-12"><a href="sampling.html#cb1-12" aria-hidden="true" tabindex="-1"></a> <span class="cf">if</span>(indi_output) {</span>
<span id="cb1-13"><a href="sampling.html#cb1-13" aria-hidden="true" tabindex="-1"></a> temp <span class="ot">&lt;-</span> 1L<span class="sc">:</span>N</span>
<span id="cb1-14"><a href="sampling.html#cb1-14" aria-hidden="true" tabindex="-1"></a> output <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(temp <span class="sc">%in%</span> the_sample)</span>
<span id="cb1-15"><a href="sampling.html#cb1-15" aria-hidden="true" tabindex="-1"></a> <span class="fu">return</span>(output) }</span>
<span id="cb1-16"><a href="sampling.html#cb1-16" aria-hidden="true" tabindex="-1"></a> <span class="fu">return</span>(the_sample)</span>
<span id="cb1-17"><a href="sampling.html#cb1-17" aria-hidden="true" tabindex="-1"></a>}  </span></code></pre></div>
<p><strong>Example:</strong> Suppose <span class="math inline">\(N=10\)</span> and <span class="math inline">\(n=3\)</span>. We can show all the possible samples resulted from systematic sampling.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="sampling.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-2"><a href="sampling.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb2-3"><a href="sampling.html#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb2-4"><a href="sampling.html#cb2-4" aria-hidden="true" tabindex="-1"></a>a_tbl <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(<span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, </span>
<span id="cb2-5"><a href="sampling.html#cb2-5" aria-hidden="true" tabindex="-1"></a>                          <span class="cf">function</span>(s) <span class="fu">sys_sampling</span>(<span class="at">N =</span> <span class="dv">10</span>, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">start =</span> s))) </span>
<span id="cb2-6"><a href="sampling.html#cb2-6" aria-hidden="true" tabindex="-1"></a>col_names <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;s_&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb2-7"><a href="sampling.html#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(a_tbl) <span class="ot">&lt;-</span> col_names</span>
<span id="cb2-8"><a href="sampling.html#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(a_tbl, <span class="st">&quot;html&quot;</span>, <span class="at">align =</span> <span class="fu">rep</span>(<span class="st">&#39;c&#39;</span>, <span class="dv">10</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-9"><a href="sampling.html#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
s_1
</th>
<th style="text-align:center;">
s_2
</th>
<th style="text-align:center;">
s_3
</th>
<th style="text-align:center;">
s_4
</th>
<th style="text-align:center;">
s_5
</th>
<th style="text-align:center;">
s_6
</th>
<th style="text-align:center;">
s_7
</th>
<th style="text-align:center;">
s_8
</th>
<th style="text-align:center;">
s_9
</th>
<th style="text-align:center;">
s_10
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
3
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
6
</td>
</tr>
<tr>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
10
</td>
</tr>
</tbody>
</table>
<p>It is easy to notice that each unit has selection probability
<span class="math display">\[
\pi = \frac{n}{N}=\frac{3}{10}.
\]</span></p>
<p>In our example, while simple random sampling results in 120 possible samples of size 3, systematic sample can result in only 10 possible samples of size 3. Judged by <strong>Randomization principle</strong>, systematic sampling is worse than simple random sampling. However, systematic sampling is often used by practitioners because of its simplicity.</p>
</div>
<div id="probability-proportional-to-size" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Probability proportional to size<a href="sampling.html#probability-proportional-to-size" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In a sampling design, an important part is to determine <em>selection probabilities</em>, which accompany the units in the population. In terms of selection probabilities, we can distinguish two cases. Case 1: all the selection probabilities are equal. Case 2: the selection probabilities are not equal. Simple random sampling is an example of Case 1; probability proportional to size (PPS) is a method for creating unequal selection probabilities, i.e. it’s Case 2.</p>
<p>With PPS, the selection probability of unit <span class="math inline">\(i\)</span> is defined as
<span class="math display" id="eq:pi">\[\begin{equation}
\pi_i = n \frac{U_i}{\sum_{i=1}^N U_i},\ \text{for}\ i=1, \ldots, N,
\tag{2.1}
\end{equation}\]</span>
where <span class="math inline">\(n\)</span> and <span class="math inline">\(N\)</span> are the sample size and population size, respectively, <span class="math inline">\(U_i\)</span> is the <em>size/importance</em> of unit <span class="math inline">\(i\)</span>.</p>
<p><strong>R program:</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="sampling.html#cb3-1" aria-hidden="true" tabindex="-1"></a>pps_action <span class="ot">&lt;-</span> <span class="cf">function</span>(size_vec, the_n)</span>
<span id="cb3-2"><a href="sampling.html#cb3-2" aria-hidden="true" tabindex="-1"></a>{the_re <span class="ot">&lt;-</span> the_n <span class="sc">*</span> (size_vec <span class="sc">/</span> <span class="fu">sum</span>(size_vec))</span>
<span id="cb3-3"><a href="sampling.html#cb3-3" aria-hidden="true" tabindex="-1"></a> the_n_fixed <span class="ot">&lt;-</span> the_n</span>
<span id="cb3-4"><a href="sampling.html#cb3-4" aria-hidden="true" tabindex="-1"></a> <span class="cf">while</span>(<span class="dv">1</span>) {</span>
<span id="cb3-5"><a href="sampling.html#cb3-5" aria-hidden="true" tabindex="-1"></a>   bad_ones_index <span class="ot">&lt;-</span> <span class="fu">which</span>(the_re <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb3-6"><a href="sampling.html#cb3-6" aria-hidden="true" tabindex="-1"></a>   good_ones_index <span class="ot">&lt;-</span> <span class="fu">which</span>(the_re <span class="sc">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb3-7"><a href="sampling.html#cb3-7" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span>(<span class="sc">!</span><span class="fu">length</span>(bad_ones_index)) <span class="fu">return</span>(the_re)</span>
<span id="cb3-8"><a href="sampling.html#cb3-8" aria-hidden="true" tabindex="-1"></a>   the_re[bad_ones_index] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb3-9"><a href="sampling.html#cb3-9" aria-hidden="true" tabindex="-1"></a>   m <span class="ot">&lt;-</span> <span class="fu">sum</span>(the_re <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb3-10"><a href="sampling.html#cb3-10" aria-hidden="true" tabindex="-1"></a>   the_n <span class="ot">&lt;-</span> the_n_fixed <span class="sc">-</span> m</span>
<span id="cb3-11"><a href="sampling.html#cb3-11" aria-hidden="true" tabindex="-1"></a>   the_re[good_ones_index] <span class="ot">&lt;-</span></span>
<span id="cb3-12"><a href="sampling.html#cb3-12" aria-hidden="true" tabindex="-1"></a>     the_n <span class="sc">*</span> (size_vec[good_ones_index] <span class="sc">/</span> <span class="fu">sum</span>(size_vec[good_ones_index]))</span>
<span id="cb3-13"><a href="sampling.html#cb3-13" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb3-14"><a href="sampling.html#cb3-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Remarks:</strong></p>
<ol style="list-style-type: decimal">
<li><p>If some of <span class="math inline">\(\pi_i\)</span> resulted from <a href="sampling.html#eq:pi">(2.1)</a> are greater than 1, then we set them as 1, and recalculate the rest <span class="math inline">\(\pi_i\)</span>’s. The iteration process finishes until no <span class="math inline">\(\pi\)</span>’s are greater than 1.</p></li>
<li><p>It is easy to see from <a href="sampling.html#eq:pi">(2.1)</a> that
<span class="math display" id="eq:pisum">\[\begin{equation}
\sum_{i=1}^N \pi_i = n.
\tag{2.2}
\end{equation}\]</span>
Actually, <a href="sampling.html#eq:pisum">(2.2)</a> always holds true if the sample size is fixed as <span class="math inline">\(n\)</span>—see a proof in ???.
<!-- below is a quick proof: -->
<!-- \begin{align} -->
<!-- \sum_{i=1}^N \pi_i &= \sum_{i=1}^N\sum_{i\in s}p(s) \notag\\ -->
<!-- &= n\sum_{s\in \Omega}p(s) \notag\\ -->
<!-- &= n\times 1 \notag\\ -->
<!-- &= n. \notag -->
<!-- \end{align} --></p></li>
</ol>
</div>
<div id="systematic-sampling-with-unequal-selection-probabilities" class="section level3 hasAnchor" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> Systematic sampling with unequal selection probabilities<a href="sampling.html#systematic-sampling-with-unequal-selection-probabilities" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The settings are:</p>
<ul>
<li>Population has <span class="math inline">\(N\)</span> units, and they are referred to as units 1, 2, <span class="math inline">\(\ldots\)</span>, <span class="math inline">\(N\)</span>.</li>
<li>Unit <span class="math inline">\(i\)</span> has selection probability <span class="math inline">\(\pi_i\)</span>.</li>
</ul>
<p>Note that
<span class="math display">\[
\sum_{i=1}^N \pi_i = n,
\]</span>
where <span class="math inline">\(n\)</span> is the sample size.</p>
<p>In Section <a href="sampling.html#sys1">2.3.1</a>, we study systematic sampling, where the selection probabilities are
all equal. An interesting question is: If the selection probabilities are not equal, how
do we do systematic sampling? According to Antoine (2015) and Tillé (2010), an algorithm is as follows:</p>
<ol style="list-style-type: decimal">
<li>Generate a random number from Uniform(0, 1), say it is <span class="math inline">\(u\)</span>.</li>
<li>Each unit in the population owns an interval, i.e. unit 1 owns interval <span class="math inline">\((0,\ \pi_1)\)</span>; unit 2 owns interval <span class="math inline">\((\pi_1,\ \sum_{i=1}^2 \pi_i)\)</span>; <span class="math inline">\(\cdots\)</span>; unit <span class="math inline">\(N\)</span> owns interval <span class="math inline">\((\sum_{i=1}^{N-1}\pi_i,\ n)\)</span>. Then, we find the intervals that contain <span class="math inline">\(u\)</span>, or <span class="math inline">\(u+1\)</span>, <span class="math inline">\(\cdots\)</span>, or <span class="math inline">\(u+(n-1)\)</span>, and the <span class="math inline">\(n\)</span> units that own these intervals are selected as a sample.</li>
</ol>
<p>The following is an R program that implements the algorithm.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="sampling.html#cb4-1" aria-hidden="true" tabindex="-1"></a>sys_smpling_with_sel_prob <span class="ot">&lt;-</span> <span class="cf">function</span>(sel_prob)</span>
<span id="cb4-2"><a href="sampling.html#cb4-2" aria-hidden="true" tabindex="-1"></a>{u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb4-3"><a href="sampling.html#cb4-3" aria-hidden="true" tabindex="-1"></a> cum_sel_prob <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(sel_prob)</span>
<span id="cb4-4"><a href="sampling.html#cb4-4" aria-hidden="true" tabindex="-1"></a> m <span class="ot">&lt;-</span> <span class="fu">length</span>(sel_prob)</span>
<span id="cb4-5"><a href="sampling.html#cb4-5" aria-hidden="true" tabindex="-1"></a> s <span class="ot">&lt;-</span> <span class="fu">rep</span>(0L, m)</span>
<span id="cb4-6"><a href="sampling.html#cb4-6" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb4-7"><a href="sampling.html#cb4-7" aria-hidden="true" tabindex="-1"></a> {s[i] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(u <span class="sc">&lt;=</span> cum_sel_prob[i])</span>
<span id="cb4-8"><a href="sampling.html#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(s[i] <span class="sc">==</span> 1L) u <span class="ot">&lt;-</span> u <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb4-9"><a href="sampling.html#cb4-9" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb4-10"><a href="sampling.html#cb4-10" aria-hidden="true" tabindex="-1"></a> <span class="fu">return</span>(s)</span>
<span id="cb4-11"><a href="sampling.html#cb4-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The R function <code>UPsystematic()</code> in <strong><code>sampling</code></strong> package can do systematic sampling with
unequal probabilities. Below, we show an example to test <code>sys_smpling_with_sel_prob()</code> and <code>sampling::UPsystematic()</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="sampling.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sampling)</span>
<span id="cb5-2"><a href="sampling.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb5-3"><a href="sampling.html#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb5-4"><a href="sampling.html#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="sampling.html#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># for evaluation</span></span>
<span id="cb5-6"><a href="sampling.html#cb5-6" aria-hidden="true" tabindex="-1"></a>eval_sampling <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">it_nbr =</span> <span class="dv">10000</span>, selec_prob, the_func)</span>
<span id="cb5-7"><a href="sampling.html#cb5-7" aria-hidden="true" tabindex="-1"></a>{the_vec <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>it_nbr, </span>
<span id="cb5-8"><a href="sampling.html#cb5-8" aria-hidden="true" tabindex="-1"></a>                          <span class="cf">function</span>(x) <span class="fu">which</span>(<span class="fu">the_func</span>(selec_prob) <span class="sc">==</span> <span class="dv">1</span>)))</span>
<span id="cb5-9"><a href="sampling.html#cb5-9" aria-hidden="true" tabindex="-1"></a> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(the_vec)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-10"><a href="sampling.html#cb5-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">relative_freq =</span> Freq <span class="sc">/</span> it_nbr) <span class="sc">%&gt;%</span> </span>
<span id="cb5-11"><a href="sampling.html#cb5-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">the_pi =</span> selec_prob)</span>
<span id="cb5-12"><a href="sampling.html#cb5-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-13"><a href="sampling.html#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="sampling.html#cb5-14" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span>  <span class="dv">6</span></span>
<span id="cb5-15"><a href="sampling.html#cb5-15" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span>  <span class="dv">3</span></span>
<span id="cb5-16"><a href="sampling.html#cb5-16" aria-hidden="true" tabindex="-1"></a>selc_prob <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">*</span> (<span class="dv">1</span><span class="sc">:</span>N)<span class="sc">/</span><span class="fu">sum</span>(<span class="dv">1</span><span class="sc">:</span>N) </span>
<span id="cb5-17"><a href="sampling.html#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="sampling.html#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple example - sample selection </span></span>
<span id="cb5-19"><a href="sampling.html#cb5-19" aria-hidden="true" tabindex="-1"></a>the_re_4_sys <span class="ot">&lt;-</span> <span class="fu">eval_sampling</span>(<span class="at">selec_prob =</span> selc_prob, </span>
<span id="cb5-20"><a href="sampling.html#cb5-20" aria-hidden="true" tabindex="-1"></a>                              <span class="at">the_func =</span> sys_smpling_with_sel_prob)</span>
<span id="cb5-21"><a href="sampling.html#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(the_re_4_sys)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
the_vec
</th>
<th style="text-align:right;">
Freq
</th>
<th style="text-align:right;">
relative_freq
</th>
<th style="text-align:right;">
the_pi
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
1427
</td>
<td style="text-align:right;">
0.1427
</td>
<td style="text-align:right;">
0.1428571
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
2875
</td>
<td style="text-align:right;">
0.2875
</td>
<td style="text-align:right;">
0.2857143
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
4298
</td>
<td style="text-align:right;">
0.4298
</td>
<td style="text-align:right;">
0.4285714
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
5702
</td>
<td style="text-align:right;">
0.5702
</td>
<td style="text-align:right;">
0.5714286
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
7125
</td>
<td style="text-align:right;">
0.7125
</td>
<td style="text-align:right;">
0.7142857
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
8573
</td>
<td style="text-align:right;">
0.8573
</td>
<td style="text-align:right;">
0.8571429
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="sampling.html#cb6-1" aria-hidden="true" tabindex="-1"></a>the_re_4_UPmaxentropy <span class="ot">&lt;-</span> <span class="fu">eval_sampling</span>(<span class="at">selec_prob =</span> selc_prob, </span>
<span id="cb6-2"><a href="sampling.html#cb6-2" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">the_func =</span> UPmaxentropy)</span>
<span id="cb6-3"><a href="sampling.html#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(the_re_4_UPmaxentropy)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
the_vec
</th>
<th style="text-align:right;">
Freq
</th>
<th style="text-align:right;">
relative_freq
</th>
<th style="text-align:right;">
the_pi
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
1425
</td>
<td style="text-align:right;">
0.1425
</td>
<td style="text-align:right;">
0.1428571
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
2848
</td>
<td style="text-align:right;">
0.2848
</td>
<td style="text-align:right;">
0.2857143
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
4356
</td>
<td style="text-align:right;">
0.4356
</td>
<td style="text-align:right;">
0.4285714
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
5622
</td>
<td style="text-align:right;">
0.5622
</td>
<td style="text-align:right;">
0.5714286
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
7158
</td>
<td style="text-align:right;">
0.7158
</td>
<td style="text-align:right;">
0.7142857
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
8591
</td>
<td style="text-align:right;">
0.8591
</td>
<td style="text-align:right;">
0.8571429
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="exercises" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Exercises<a href="sampling.html#exercises" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="unit-selection-probability-in-srs" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Unit selection probability in SRS<a href="sampling.html#unit-selection-probability-in-srs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Show that in simple random sampling, each unit has a selection probability of <span class="math inline">\(n/N\)</span>, where <span class="math inline">\(n\)</span> and <span class="math inline">\(N\)</span> are sample and population sizes, respectively.</p>
<p><strong>Hint:</strong>
<span class="math display">\[
{N-1 \choose n-1}/{N \choose n}=\frac{n}{N}.
\]</span></p>
</div>
<div id="all-possible-samples-for-srs-with-replacement" class="section level3 hasAnchor" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> All possible samples for SRS with replacement<a href="sampling.html#all-possible-samples-for-srs-with-replacement" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose the population is <span class="math inline">\({\cal P}=\{1,\ 2,\ 3,\ 4,\ 5\}\)</span>. If we do SRS
with replacement, where <span class="math inline">\(n=3\)</span>. Write an R program to list all possible samples. Note that if the selection resulted in, e.g. 1, 1, 1, then the sample is {1}—i.e. we don’t keep duplicated units.</p>
<p><strong>Hint:</strong> There are
<span class="math display">\[
{5 \choose 1}+{5 \choose 2}+{5 \choose 3} = 5 + 10 + 10 = 25
\]</span>
possible samples.</p>
</div>
<div id="an-algorithm-for-drawing-an-srs" class="section level3 hasAnchor" number="2.4.3">
<h3><span class="header-section-number">2.4.3</span> An algorithm for drawing an SRS<a href="sampling.html#an-algorithm-for-drawing-an-srs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In Lohr (2010, 2022), one algorithm for drawing an SRS (Simple Random Sample without replacement) is as follows.</p>
<ol style="list-style-type: decimal">
<li>Produce <span class="math inline">\(N\)</span> random numbers from the Uniform(0, 1) distribution, and attach them to the <span class="math inline">\(N\)</span> units in the sampling frame.</li>
<li>Order the <span class="math inline">\(N\)</span> units by the generated random numbers from the smallest to largest.</li>
<li>The top <span class="math inline">\(n\)</span> units are selected as the sample.</li>
</ol>
<p>Show that, indeed, this is simple random sampling without replacement.</p>
<p><strong>Hint:</strong> We can show that each of the <span class="math inline">\({N \choose n}\)</span> possible samples of size <span class="math inline">\(n\)</span> has probability
<span class="math display">\[
\frac{n!(N-n)!}{N!},
\]</span>
which is <span class="math inline">\(1/{N \choose n}\)</span>, of being selected.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sample.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="weighting-system.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
